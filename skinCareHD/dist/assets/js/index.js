(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(e){if(e.ep)return;e.ep=!0;const s=r(e);fetch(e.href,s)}})();function l(t,n){const r=document.getElementById(t),o=r.querySelector(".circle-fg"),e=r.querySelector(".label"),s=parseFloat(getComputedStyle(o).r)||80,i=2*Math.PI*s;setTimeout(()=>{const u=i*(1-n/100);o.style.strokeDashoffset=u,e.textContent=`${n}%`},50)}let c=null;function m(t){const n=document.getElementById("resultChart");if(!n)return;const r=n.getContext("2d"),o=r.createLinearGradient(0,0,0,400);if(o.addColorStop(0,"rgba(61, 90, 254, 0.3)"),o.addColorStop(.5,"rgba(0, 176, 255, 0.3)"),o.addColorStop(1,"rgba(0, 230, 119, 0.3)"),c){c.data.datasets[0].data=t,c.update();return}console.log("HERE");const e={type:"radar",data:{labels:["痘痘/粉刺","色斑/色素沉澱","皮膚保濕度","皮脂分泌量","臉部光澤度/透亮度","全臉皺紋整體分數"],datasets:[{label:"皮膚分析分數",data:[89,78,50,59,99,100],fill:!0,backgroundColor:o,borderColor:"#3D5AFE",pointBackgroundColor:"#fff",pointBorderColor:"rgb(0, 176, 255)",pointHoverBackgroundColor:"rgb(0, 176, 255)",pointHoverBorderColor:"rgb(0, 176, 255)"}]},options:{responsive:!1,elements:{line:{borderWidth:1}},scales:{r:{angleLines:{display:!1},suggestedMin:0,suggestedMax:100,ticks:{color:"#3D5AFE",backdropColor:"transparent",stepSize:25},grid:{color:"rgba(0, 176, 255, 0.3)"},pointLabels:{color:"#3D5AFE"}}},plugins:{legend:{display:!1}}}};c=new Chart(r,e)}function k(){const t=document.querySelectorAll('input[name="frame-select"]'),n=document.getElementById("frame-preview");t.forEach(r=>{r.addEventListener("change",()=>{r.checked&&(n.src=`./assets/images/frames/Frame${r.value}.png`,n.alt=`Frame ${r.value} 預覽`)})})}function S(){document.querySelector(".p-index-frames").style.display="block",document.querySelector(".p-index-download").style.display="block"}function b(){console.log("有到這邊？"),document.querySelector("#result_ID").style.display="block"}const C={language:"cht",hideButtonsOnResultPage:!0,hideSkinAnalysisResult:!0,downloadPhotoMode:"direct",width:400,height:600,disableResolutionCheck:!0};let d=!1,a={};document.querySelector(".p-index-photo img");function E(){window.ymkAsyncInit=function(){YMK.init(C),YMK.openSkincare(),YMK.addEventListener("skinAnalysisCompleted",function(t){console.log("分析完成，圖片可以擷取了"),d=!0,a=t,YMK.setSkincareResultType(""),R(),S()})}}function R(){if(d){console.log("=== 完整分析結果 ==="),console.log(a),l("acne",a.acne),l("ageSpots",a.ageSpots),l("moisture",a.moisture),l("oiliness",a.oiliness),l("radiance",a.radiance),l("wrinkles",a.wrinkles);const t=document.getElementById("skinAge"),n=document.getElementById("skinHealth");t.textContent=a.skinAge,n.textContent=a.skinHealth,window.ymkAnalysisData=[a.acne,a.ageSpots,a.moisture,a.oiliness,a.radiance,a.wrinkles],console.log(window.ymkAnalysisData),m(window.ymkAnalysisData)}}function I(){if(!d){alert("分析還沒完成喔，請稍候再試！");return}YMK.snapshotSkincareResult(["oiliness"],{}).then(function(t){if(!t||t===!1){alert("擷取失敗，請確認是否啟用權限！");return}p(t)})}function x(){if(!d){alert("分析還沒完成喔，請稍候再試！");return}YMK.snapshot("base64",function(t){if(!t||t===!1){alert("擷取失敗，請確認是否啟用權限！");return}p(t)})}function p(t){YMK.setSkincareResultType(""),b();const n=t,r=document.createElement("a");r.download="snapshot.jpg";const o=new Image;o.crossOrigin="anonymous",o.src=n,o.onload=()=>{const e=document.createElement("canvas");e.width=o.naturalWidth,e.height=o.naturalHeight;const s=e.getContext("2d");s.drawImage(o,0,0,e.width,e.height);const i=new Image;i.crossOrigin="anonymous",i.src=document.querySelector(".p-index-ymk-frames img").src,i.onload=()=>{s.drawImage(i,0,0,e.width,e.height);const u=document.querySelector(".p-index-photo img"),h=e.toDataURL("image/jpeg");u.src=h,e.toBlob(y=>{const w=URL.createObjectURL(y);r.href=w,r.click()},"image/jpeg")},i.onerror=()=>{alert("框圖載入失敗，請確認路徑正確！")}}}async function A(){const t=takePhoto,n={quality:1,bgcolor:"#fff",style:{backgroundColor:"rgba(0, 176, 255, 0.1)",borderRadius:"50px"}},r=await domtoimage.toPng(t,n).then(e=>e),o=document.createElement("a");o.download="result.jpg",o.href=r,o.click()}const g=document.querySelector(".p-index-app"),v=document.querySelector(".p-index-ymk-wrapper"),L=400,q=600;function B(){window.innerWidth>=500&&f(),window.addEventListener("resize",function(){window.innerWidth>=500&&f()})}function f(){const t=g.clientWidth/L;console.log("container.clientWidth",g.clientWidth),v.style.transform=`scale(${t})`,g.style.height=`${q*t}px`}E();k();B();m();window.downloadSnapshotSkincareResult=I;window.downloadSnapshot=x;window.downloadResult=A;
